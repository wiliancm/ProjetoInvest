using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.SignalR.Protocol;
using Newtonsoft.Json;
using System;
using System.Collections.Specialized;
using System.Diagnostics;
using System.Net;
using System.Net.Mime;
using System.Text;
using WEB.Models;
using static System.Runtime.InteropServices.JavaScript.JSType;

namespace WEB.Controllers
{
    public class HomeController : Controller
    {
        Uri baseAddress = new Uri("https://investidor10.com.br");
        public ResumoDTO resumoDTO = new ResumoDTO();
        private const string SessionIdCarteira = "SessionIdCarteira";
        private const string SessionCarteira = "SessionCarteira";

        public HomeController()
        {
        }

        public IActionResult Index()
        {
            resumoDTO = JsonConvert.DeserializeObject<ResumoDTO>(HttpContext.Session.GetString(SessionCarteira) ?? string.Empty) ?? new ResumoDTO();

            if (resumoDTO.Iniciado)
            {
                return View(true);
            }
            else
            {
                return View(false);
            }
        }

        public IActionResult CarregaDados(string idCarteira)
        {
            var _idCarteira = HttpContext.Session.GetString(SessionIdCarteira) ?? string.Empty;
            resumoDTO = JsonConvert.DeserializeObject<ResumoDTO>(HttpContext.Session.GetString(SessionCarteira) ?? string.Empty) ?? new ResumoDTO();

            if (!resumoDTO.Iniciado || resumoDTO.DataAtualizado.AddMinutes(5) < DateTime.Now || _idCarteira != idCarteira)
            {
                _idCarteira = string.IsNullOrEmpty(idCarteira) ? _idCarteira : idCarteira;

                using (var handler = new HttpClientHandler { UseCookies = false })
                using (var client = new HttpClient(handler) { BaseAddress = baseAddress })
                {
                    var message = new HttpRequestMessage(HttpMethod.Get, "/api/carteiras/datatable/ativos/" + _idCarteira + "/Ticker?draw=1&columns%5B0%5D%5Bdata%5D=ticker&columns%5B0%5D%5Bname%5D=ticker&columns%5B0%5D%5Bsearchable%5D=true&columns%5B0%5D%5Borderable%5D=true&columns%5B0%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B0%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B1%5D%5Bdata%5D=quantity&columns%5B1%5D%5Bname%5D=quantity&columns%5B1%5D%5Bsearchable%5D=true&columns%5B1%5D%5Borderable%5D=true&columns%5B1%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B1%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B2%5D%5Bdata%5D=avg_price&columns%5B2%5D%5Bname%5D=avg_price&columns%5B2%5D%5Bsearchable%5D=true&columns%5B2%5D%5Borderable%5D=true&columns%5B2%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B2%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B3%5D%5Bdata%5D=current_price&columns%5B3%5D%5Bname%5D=current_price&columns%5B3%5D%5Bsearchable%5D=true&columns%5B3%5D%5Borderable%5D=true&columns%5B3%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B3%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B4%5D%5Bdata%5D=graham&columns%5B4%5D%5Bname%5D=graham&columns%5B4%5D%5Bsearchable%5D=true&columns%5B4%5D%5Borderable%5D=true&columns%5B4%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B4%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B5%5D%5Bdata%5D=bazin&columns%5B5%5D%5Bname%5D=bazin&columns%5B5%5D%5Bsearchable%5D=true&columns%5B5%5D%5Borderable%5D=true&columns%5B5%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B5%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B6%5D%5Bdata%5D=appreciation&columns%5B6%5D%5Bname%5D=appreciation&columns%5B6%5D%5Bsearchable%5D=true&columns%5B6%5D%5Borderable%5D=true&columns%5B6%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B6%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B7%5D%5Bdata%5D=equity_total&columns%5B7%5D%5Bname%5D=equity_total&columns%5B7%5D%5Bsearchable%5D=true&columns%5B7%5D%5Borderable%5D=true&columns%5B7%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B7%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B8%5D%5Bdata%5D=payout&columns%5B8%5D%5Bname%5D=payout&columns%5B8%5D%5Bsearchable%5D=true&columns%5B8%5D%5Borderable%5D=true&columns%5B8%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B8%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B9%5D%5Bdata%5D=p_l&columns%5B9%5D%5Bname%5D=p_l&columns%5B9%5D%5Bsearchable%5D=true&columns%5B9%5D%5Borderable%5D=true&columns%5B9%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B9%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B10%5D%5Bdata%5D=p_vp&columns%5B10%5D%5Bname%5D=p_vp&columns%5B10%5D%5Bsearchable%5D=true&columns%5B10%5D%5Borderable%5D=true&columns%5B10%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B10%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B11%5D%5Bdata%5D=dy&columns%5B11%5D%5Bname%5D=dy&columns%5B11%5D%5Bsearchable%5D=true&columns%5B11%5D%5Borderable%5D=true&columns%5B11%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B11%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B12%5D%5Bdata%5D=yoc&columns%5B12%5D%5Bname%5D=yoc&columns%5B12%5D%5Bsearchable%5D=true&columns%5B12%5D%5Borderable%5D=true&columns%5B12%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B12%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B13%5D%5Bdata%5D=roe&columns%5B13%5D%5Bname%5D=roe&columns%5B13%5D%5Bsearchable%5D=true&columns%5B13%5D%5Borderable%5D=true&columns%5B13%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B13%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B14%5D%5Bdata%5D=net_margin&columns%5B14%5D%5Bname%5D=net_margin&columns%5B14%5D%5Bsearchable%5D=true&columns%5B14%5D%5Borderable%5D=true&columns%5B14%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B14%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B15%5D%5Bdata%5D=gross_margin&columns%5B15%5D%5Bname%5D=gross_margin&columns%5B15%5D%5Bsearchable%5D=true&columns%5B15%5D%5Borderable%5D=true&columns%5B15%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B15%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B16%5D%5Bdata%5D=gnr&columns%5B16%5D%5Bname%5D=gnr&columns%5B16%5D%5Bsearchable%5D=true&columns%5B16%5D%5Borderable%5D=true&columns%5B16%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B16%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B17%5D%5Bdata%5D=gnp&columns%5B17%5D%5Bname%5D=gnp&columns%5B17%5D%5Bsearchable%5D=true&columns%5B17%5D%5Borderable%5D=true&columns%5B17%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B17%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B18%5D%5Bdata%5D=rating&columns%5B18%5D%5Bname%5D=rating&columns%5B18%5D%5Bsearchable%5D=true&columns%5B18%5D%5Borderable%5D=true&columns%5B18%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B18%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B19%5D%5Bdata%5D=percent_wallet&columns%5B19%5D%5Bname%5D=percent_wallet&columns%5B19%5D%5Bsearchable%5D=true&columns%5B19%5D%5Borderable%5D=true&columns%5B19%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B19%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B20%5D%5Bdata%5D=percent_ideal&columns%5B20%5D%5Bname%5D=percent_ideal&columns%5B20%5D%5Bsearchable%5D=true&columns%5B20%5D%5Borderable%5D=true&columns%5B20%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B20%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B21%5D%5Bdata%5D=percent_wallet_type&columns%5B21%5D%5Bname%5D=percent_wallet_type&columns%5B21%5D%5Bsearchable%5D=true&columns%5B21%5D%5Borderable%5D=true&columns%5B21%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B21%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B22%5D%5Bdata%5D=percent_ideal_type&columns%5B22%5D%5Bname%5D=percent_ideal_type&columns%5B22%5D%5Bsearchable%5D=true&columns%5B22%5D%5Borderable%5D=true&columns%5B22%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B22%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B23%5D%5Bdata%5D=buy&columns%5B23%5D%5Bname%5D=buy&columns%5B23%5D%5Bsearchable%5D=true&columns%5B23%5D%5Borderable%5D=true&columns%5B23%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B23%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B24%5D%5Bdata%5D=avg_rating&columns%5B24%5D%5Bname%5D=avg_rating&columns%5B24%5D%5Bsearchable%5D=true&columns%5B24%5D%5Borderable%5D=false&columns%5B24%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B24%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B25%5D%5Bdata%5D=25&columns%5B25%5D%5Bname%5D=&columns%5B25%5D%5Bsearchable%5D=true&columns%5B25%5D%5Borderable%5D=false&columns%5B25%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B25%5D%5Bsearch%5D%5Bregex%5D=false&order%5B0%5D%5Bcolumn%5D=7&order%5B0%5D%5Bdir%5D=desc&start=0&length=35&search%5Bvalue%5D=&search%5Bregex%5D=false&_=1712351366464");
                    message.Headers.Add("Referer", "https://investidor10.com.br/carteiras/resumo/" + _idCarteira + "/");
                    message.Headers.Add("Sec-Ch-Ua", "\"Not A(Brand\";v=\"99\", \"Opera GX\";v=\"107\", \"Chromium\";v=\"121\"");
                    message.Headers.Add("Sec-Ch-Ua-Mobile", "?0");
                    message.Headers.Add("Sec-Ch-Ua-Platform", "\"Windows\"");
                    message.Headers.Add("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 OPR/107.0.0.0");
                    message.Headers.Add("X-Csrf-Token", "s4D8X0AYgOi7N6W3PzO2QExfC5KhLye3rokmHkwy");
                    message.Headers.Add("Cookie", "ads_popup=eyJpdiI6IktXWWpuYmpHbXFxQWhlNlovbVlvVHc9PSIsInZhbHVlIjoid1NEV0ZrOER5a1BTMU9VSnZYSmlhbHZxVlZBNFUwVzluTzlLR1dCRWZsYm5nU0l3SDBwcTltSS81QitBZTMwWklTRytMVEN1a2REU2ljcEs5U3BQS0luRmloeXd1Tlgva2NZZm1YbVVqV1k9IiwibWFjIjoiNWM5N2U0NWMzZDcxMzRhY2JjNTJhOTU4MDM4YTg0NTFlODAwNGM0N2QxZmExOTM2MDRhYmMzZWNjMTFmZTllNyJ9; sib_cuid=2eb71b24-0d30-478e-9f7f-14845f1a2ff7; SLG_G_WPT_TO=pt; _fbp=fb.2.1711243835452.776130160; SLG_GWPT_Show_Hide_tmp=1; SLG_wptGlobTipTmp=1; g_state={\"i_l\":0}; _gcl_au=1.1.181278894.1711243843; remember_web_59ba36addc2b2f9401580f014c7f58ea4e30989d=eyJpdiI6IjZUNmY5Wlgwd2JQNUxsQzEraklaT1E9PSIsInZhbHVlIjoiYVZJZFhoazhUZ3kxMnBmajh4TmFDZWtybUp6N3ZreFl5QlYzbkVuRGhpSmxCN3kwTjlaTEpsQjBZejhBSXBVcTNPaWE3S1FxLzFEbHEwT05jUEJCMnU2b3dvYTJXaElxS2JkSlBsVUNoSEFOby84dU1uUlY1ZDZZdWpzWXBIaTQ5TzRVMFNQbUF5VnNGaWQ5aHdYM3JnPT0iLCJtYWMiOiI0NDM1MDI2YjMwYWRmOTk4ZmY5YmYzOTkzZDRjMmY5Zjc4ODk1M2M0YmViMTA5NmExMzk2NTk3MDlmN2UyZTUwIn0%3D; _hjSessionUser_2058627=eyJpZCI6IjRhNGU2MmQ5LTUyZDMtNTJlMC04ZTdlLWU4MmZlOGFiZmM5NyIsImNyZWF0ZWQiOjE3MTEyNDQxODUyMzgsImV4aXN0aW5nIjp0cnVlfQ==; counter_pro=1711450640185; buy_and_hold=5; _uetvid=3a091730eb5811eea408db95503cba0d; blueID=b70e7765-08b3-4576-9eb7-69e818325628; _ga_3TXVTJSHD7=GS1.1.1711447465.1.0.1711447467.58.0.0; _ga_5EQ309XQDG=deleted; _gid=GA1.3.1279291321.1712131702; _ga_267511960=deleted; zabUserId=1712255828296zabu0.9642663688227961; zps-tgr-dts=sc%3D1-expAppOnNewSession%3D%5B%5D-pc%3D1-sesst%3D1712255828526; zpsfa_CrrM31V=1712255828708psf0.30054752858981804; cookie_contador_whole-site=eyJpdiI6Inowd05KdElOckpiSmt1L3F0N0gxUHc9PSIsInZhbHVlIjoiajFZWlNHOEZna2hUMlRRSVdSZDVtMmFxZGVYQlFCTmNNekt1VUhSYURTeXBCeUJnbEdER1NGdmhaOGZEbXhaN0ZCaTR0UHd1a1I2RDlYZ2RKbyt5ZUE9PSIsIm1hYyI6ImNhZTNjYWFlYjIyYzU5NzFmNTliNmYxYzU2MTEwNDIwOTg0ZmVhODA2ZDhiMTNjMDZhYjZjZTcwZmQ0MTg5YTAifQ%3D%3D; cookie_contador_carteira=eyJpdiI6IkdMbXJUaDFuZzVHbCtxb1FrRnFVNHc9PSIsInZhbHVlIjoidU9abzJwalJWandVd1pLTkZvOXAxaW5HdHg3ckFxcUtRWkpYeGlqaHlRR1ozRkJDa1NCd2dUeU8ySE5Jd3V6UWQycFBDK1hTaFU5N1pqcm5vNUtaYVE9PSIsIm1hYyI6ImUwNGYwOWE1ZjRhN2Q4NmZmN2Q5MDNmOTM0ZWRkNWVhOWRlNDcyZGQyZjRlN2I4ZTEwZGY4Zjc0MmY5MmE2YTIifQ%3D%3D; _ce.irv=new; cebs=1; _ce.clock_event=1; _ce.clock_data=629%2C109.51.218.16%2C1%2C36489d387fc8bef5e6ceaf2293b7a987; _CEFT=Q%3D%3D%3D; ads_popup=1; __eoi=ID=edbd65bc1056994b:T=1712331952:RT=1712331952:S=AA-AfjZM1ZzESX4WLZK6Y-JX1Tsn; click_id_197=eyJpdiI6ImlnN0hncVREQ3NXNi9zTHhpMVNwaEE9PSIsInZhbHVlIjoiVFFPc1dyOGZGVjdKTU8wUEZXTFhYZXBmaWhyejB4ODRHU2dicGlFOE5WQktCMlJQdmEvejRqUkEwN3NMbVA3ViIsIm1hYyI6IjNjOTgzYWEyZDA3MmVjOTMyYzBkMDQ4M2ZiZjkyNmJiNmZiNzE1M2UxZWIzZTQwNjYzNDQ4ZDExMDk0ZTdlMGMifQ%3D%3D; pro_ref_v2=eyJpdiI6Ik9kSUFnaGtzNTA0NzgrY2VZeElqcWc9PSIsInZhbHVlIjoidTc5OWhPTFEzUFVtQXJ1cTVmeHN0a1pXajZ3L1krenhuY1J4b2dpeW9wWEpJcmZsOGxtdEIzWUl5N2J0VnVpYSIsIm1hYyI6IjE0OTRlZWQxMmMxODZmYjIzY2JkMGNiMTY5NTU4MTkzMzNjYjYzOWU1Zjg3ZmMyZGFiOWFkYzgzNGIzYjAwNDEifQ%3D%3D; _hjSession_2058627=eyJpZCI6Ijk0NjQ2NWEyLTNmZTktNGFmOC04NDExLTMxZjk0YzEzZTY2OCIsImMiOjE3MTIzMzU0MjkwNjAsInMiOjAsInIiOjAsInNiIjowLCJzciI6MCwic2UiOjAsImZzIjowLCJzcCI6MH0=; _ga_267511960=GS1.1.1712335428.53.1.1712335432.0.0.0; sc_is_visitor_unique=rx12923067.1712335432.9327AC08AFA94F360B785E0ADF3E47E7.54.38.28.23.16.11.4.2.2; _ga=GA1.1.142919118.1711243835; _ga_5EQ309XQDG=GS1.1.1712335428.53.1.1712335432.56.0.0; cebsp_=17; XSRF-TOKEN=eyJpdiI6ImFHa2RkOEtTazQ4TmNQMUQwcks3c3c9PSIsInZhbHVlIjoiQTVoRVZHUVBORGxvaUxlbWZvWW15byttNDVva0s2THN1ZjF1cFZJMG5SakR1UUw5TlFaMENOL2dCRzBNMmg0SEczWDJFV1JJdXlEOThpd3V0dGV1NnY3UUx3cmhEZFpqTFpUTXB2V0h6b01kS0QvOUNmY2tnSk8wQndEUjYzaWkiLCJtYWMiOiIzNzNlMzk0OGE2M2I2NDU3ZDBkY2ExMGYwMmRiZGJiNGVhYjI1NjE0ODVkM2ZhMmZkZTRkZGIwNzUyZDMzMGJiIn0%3D; laravel_session=eyJpdiI6IjVNRkZsWGlkVTN3MUwrd2I1NC8xN1E9PSIsInZhbHVlIjoiMjIxdEdESUh6VnNrUU1Jc0pocXhDOTF1RXprRzNlNFRobDVIdUh0RWJScVlxcXc1N1I1WC9oeVBnUGtVOXlLQVByOURLQmFBWERtMFpPSVJhY3MzNXczL3cxMGFmbFhpSjBDT04wL3RzTVpkbVVIRjZaNG9wK0VJME1MbHlSUGgiLCJtYWMiOiJmNzhhMWZlODE4ZTUyYjQxNjJkYjU1ZTIwMGVhOTlmYmUwOTk1YmM0ZDUxY2I2ZDk1Njg3ODg2OGU2MGRhMjA0In0%3D; _ce.s=v~c0ca04eafbf1847c30a89d9d400e0c5448d7713c~lcw~1712335757672~lva~1712305600864~vpv~0~v11.fhb~1712305601185~v11.lhb~1712335754297~gtrk.la~lumwhxs4~v11.cs~442075~v11.s~ad698cd0-f36b-11ee-8459-47712d1bcdbb~v11.sla~1712335757848~v11.send~1712335548838~lcw~1712335757848");
                    var result = client.Send(message);
                    result.EnsureSuccessStatusCode();
                    var jsonResponse = result.Content.ReadAsStringAsync();
                    resumoDTO.Ticker = JsonConvert.DeserializeObject<TickerDTO>(jsonResponse.Result);
                }

                using (var handler = new HttpClientHandler { UseCookies = false })
                using (var client = new HttpClient(handler) { BaseAddress = baseAddress })
                {
                    var message = new HttpRequestMessage(HttpMethod.Get, "/api/carteiras/datatable/ativos/" + _idCarteira + "/Fii?draw=1&columns%5B0%5D%5Bdata%5D=ticker&columns%5B0%5D%5Bname%5D=ticker&columns%5B0%5D%5Bsearchable%5D=true&columns%5B0%5D%5Borderable%5D=true&columns%5B0%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B0%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B1%5D%5Bdata%5D=segment&columns%5B1%5D%5Bname%5D=segment&columns%5B1%5D%5Bsearchable%5D=true&columns%5B1%5D%5Borderable%5D=true&columns%5B1%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B1%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B2%5D%5Bdata%5D=fii_type&columns%5B2%5D%5Bname%5D=fii_type&columns%5B2%5D%5Bsearchable%5D=true&columns%5B2%5D%5Borderable%5D=true&columns%5B2%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B2%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B3%5D%5Bdata%5D=quantity&columns%5B3%5D%5Bname%5D=quantity&columns%5B3%5D%5Bsearchable%5D=true&columns%5B3%5D%5Borderable%5D=true&columns%5B3%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B3%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B4%5D%5Bdata%5D=avg_price&columns%5B4%5D%5Bname%5D=avg_price&columns%5B4%5D%5Bsearchable%5D=true&columns%5B4%5D%5Borderable%5D=true&columns%5B4%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B4%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B5%5D%5Bdata%5D=current_price&columns%5B5%5D%5Bname%5D=current_price&columns%5B5%5D%5Bsearchable%5D=true&columns%5B5%5D%5Borderable%5D=true&columns%5B5%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B5%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B6%5D%5Bdata%5D=appreciation&columns%5B6%5D%5Bname%5D=appreciation&columns%5B6%5D%5Bsearchable%5D=true&columns%5B6%5D%5Borderable%5D=true&columns%5B6%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B6%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B7%5D%5Bdata%5D=equity_total&columns%5B7%5D%5Bname%5D=equity_total&columns%5B7%5D%5Bsearchable%5D=true&columns%5B7%5D%5Borderable%5D=true&columns%5B7%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B7%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B8%5D%5Bdata%5D=p_vp&columns%5B8%5D%5Bname%5D=p_vp&columns%5B8%5D%5Bsearchable%5D=true&columns%5B8%5D%5Borderable%5D=true&columns%5B8%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B8%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B9%5D%5Bdata%5D=dy&columns%5B9%5D%5Bname%5D=dy&columns%5B9%5D%5Bsearchable%5D=true&columns%5B9%5D%5Borderable%5D=true&columns%5B9%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B9%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B10%5D%5Bdata%5D=yoc&columns%5B10%5D%5Bname%5D=yoc&columns%5B10%5D%5Bsearchable%5D=true&columns%5B10%5D%5Borderable%5D=true&columns%5B10%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B10%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B11%5D%5Bdata%5D=rating&columns%5B11%5D%5Bname%5D=rating&columns%5B11%5D%5Bsearchable%5D=true&columns%5B11%5D%5Borderable%5D=true&columns%5B11%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B11%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B12%5D%5Bdata%5D=percent_wallet&columns%5B12%5D%5Bname%5D=percent_wallet&columns%5B12%5D%5Bsearchable%5D=true&columns%5B12%5D%5Borderable%5D=true&columns%5B12%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B12%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B13%5D%5Bdata%5D=percent_ideal&columns%5B13%5D%5Bname%5D=percent_ideal&columns%5B13%5D%5Bsearchable%5D=true&columns%5B13%5D%5Borderable%5D=true&columns%5B13%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B13%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B14%5D%5Bdata%5D=percent_wallet_type&columns%5B14%5D%5Bname%5D=percent_wallet_type&columns%5B14%5D%5Bsearchable%5D=true&columns%5B14%5D%5Borderable%5D=true&columns%5B14%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B14%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B15%5D%5Bdata%5D=percent_ideal_type&columns%5B15%5D%5Bname%5D=percent_ideal_type&columns%5B15%5D%5Bsearchable%5D=true&columns%5B15%5D%5Borderable%5D=true&columns%5B15%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B15%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B16%5D%5Bdata%5D=buy&columns%5B16%5D%5Bname%5D=buy&columns%5B16%5D%5Bsearchable%5D=true&columns%5B16%5D%5Borderable%5D=true&columns%5B16%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B16%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B17%5D%5Bdata%5D=avg_rating&columns%5B17%5D%5Bname%5D=avg_rating&columns%5B17%5D%5Bsearchable%5D=true&columns%5B17%5D%5Borderable%5D=false&columns%5B17%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B17%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B18%5D%5Bdata%5D=18&columns%5B18%5D%5Bname%5D=&columns%5B18%5D%5Bsearchable%5D=true&columns%5B18%5D%5Borderable%5D=false&columns%5B18%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B18%5D%5Bsearch%5D%5Bregex%5D=false&order%5B0%5D%5Bcolumn%5D=7&order%5B0%5D%5Bdir%5D=desc&start=0&length=35&search%5Bvalue%5D=&search%5Bregex%5D=false&_=1712446888025");
                    message.Headers.Add("Referer", "https://investidor10.com.br/carteiras/resumo/" + _idCarteira + "/");
                    message.Headers.Add("Sec-Ch-Ua", "\"Not A(Brand\";v=\"99\", \"Opera GX\";v=\"107\", \"Chromium\";v=\"121\"");
                    message.Headers.Add("Sec-Ch-Ua-Mobile", "?0");
                    message.Headers.Add("Sec-Ch-Ua-Platform", "\"Windows\"");
                    message.Headers.Add("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 OPR/107.0.0.0");
                    message.Headers.Add("X-Csrf-Token", "s4D8X0AYgOi7N6W3PzO2QExfC5KhLye3rokmHkwy");
                    message.Headers.Add("Cookie", "ads_popup=eyJpdiI6IktXWWpuYmpHbXFxQWhlNlovbVlvVHc9PSIsInZhbHVlIjoid1NEV0ZrOER5a1BTMU9VSnZYSmlhbHZxVlZBNFUwVzluTzlLR1dCRWZsYm5nU0l3SDBwcTltSS81QitBZTMwWklTRytMVEN1a2REU2ljcEs5U3BQS0luRmloeXd1Tlgva2NZZm1YbVVqV1k9IiwibWFjIjoiNWM5N2U0NWMzZDcxMzRhY2JjNTJhOTU4MDM4YTg0NTFlODAwNGM0N2QxZmExOTM2MDRhYmMzZWNjMTFmZTllNyJ9; sib_cuid=2eb71b24-0d30-478e-9f7f-14845f1a2ff7; SLG_G_WPT_TO=pt; _fbp=fb.2.1711243835452.776130160; SLG_GWPT_Show_Hide_tmp=1; SLG_wptGlobTipTmp=1; g_state={\"i_l\":0}; _gcl_au=1.1.181278894.1711243843; remember_web_59ba36addc2b2f9401580f014c7f58ea4e30989d=eyJpdiI6IjZUNmY5Wlgwd2JQNUxsQzEraklaT1E9PSIsInZhbHVlIjoiYVZJZFhoazhUZ3kxMnBmajh4TmFDZWtybUp6N3ZreFl5QlYzbkVuRGhpSmxCN3kwTjlaTEpsQjBZejhBSXBVcTNPaWE3S1FxLzFEbHEwT05jUEJCMnU2b3dvYTJXaElxS2JkSlBsVUNoSEFOby84dU1uUlY1ZDZZdWpzWXBIaTQ5TzRVMFNQbUF5VnNGaWQ5aHdYM3JnPT0iLCJtYWMiOiI0NDM1MDI2YjMwYWRmOTk4ZmY5YmYzOTkzZDRjMmY5Zjc4ODk1M2M0YmViMTA5NmExMzk2NTk3MDlmN2UyZTUwIn0%3D; _hjSessionUser_2058627=eyJpZCI6IjRhNGU2MmQ5LTUyZDMtNTJlMC04ZTdlLWU4MmZlOGFiZmM5NyIsImNyZWF0ZWQiOjE3MTEyNDQxODUyMzgsImV4aXN0aW5nIjp0cnVlfQ==; counter_pro=1711450640185; buy_and_hold=5; _uetvid=3a091730eb5811eea408db95503cba0d; blueID=b70e7765-08b3-4576-9eb7-69e818325628; _ga_3TXVTJSHD7=GS1.1.1711447465.1.0.1711447467.58.0.0; _ga_5EQ309XQDG=deleted; _gid=GA1.3.1279291321.1712131702; _ga_267511960=deleted; zabUserId=1712255828296zabu0.9642663688227961; zps-tgr-dts=sc%3D1-expAppOnNewSession%3D%5B%5D-pc%3D1-sesst%3D1712255828526; zpsfa_CrrM31V=1712255828708psf0.30054752858981804; cookie_contador_whole-site=eyJpdiI6Inowd05KdElOckpiSmt1L3F0N0gxUHc9PSIsInZhbHVlIjoiajFZWlNHOEZna2hUMlRRSVdSZDVtMmFxZGVYQlFCTmNNekt1VUhSYURTeXBCeUJnbEdER1NGdmhaOGZEbXhaN0ZCaTR0UHd1a1I2RDlYZ2RKbyt5ZUE9PSIsIm1hYyI6ImNhZTNjYWFlYjIyYzU5NzFmNTliNmYxYzU2MTEwNDIwOTg0ZmVhODA2ZDhiMTNjMDZhYjZjZTcwZmQ0MTg5YTAifQ%3D%3D; cookie_contador_carteira=eyJpdiI6IkdMbXJUaDFuZzVHbCtxb1FrRnFVNHc9PSIsInZhbHVlIjoidU9abzJwalJWandVd1pLTkZvOXAxaW5HdHg3ckFxcUtRWkpYeGlqaHlRR1ozRkJDa1NCd2dUeU8ySE5Jd3V6UWQycFBDK1hTaFU5N1pqcm5vNUtaYVE9PSIsIm1hYyI6ImUwNGYwOWE1ZjRhN2Q4NmZmN2Q5MDNmOTM0ZWRkNWVhOWRlNDcyZGQyZjRlN2I4ZTEwZGY4Zjc0MmY5MmE2YTIifQ%3D%3D; _ce.irv=new; cebs=1; _ce.clock_event=1; _ce.clock_data=629%2C109.51.218.16%2C1%2C36489d387fc8bef5e6ceaf2293b7a987; _CEFT=Q%3D%3D%3D; ads_popup=1; __eoi=ID=edbd65bc1056994b:T=1712331952:RT=1712331952:S=AA-AfjZM1ZzESX4WLZK6Y-JX1Tsn; click_id_197=eyJpdiI6ImlnN0hncVREQ3NXNi9zTHhpMVNwaEE9PSIsInZhbHVlIjoiVFFPc1dyOGZGVjdKTU8wUEZXTFhYZXBmaWhyejB4ODRHU2dicGlFOE5WQktCMlJQdmEvejRqUkEwN3NMbVA3ViIsIm1hYyI6IjNjOTgzYWEyZDA3MmVjOTMyYzBkMDQ4M2ZiZjkyNmJiNmZiNzE1M2UxZWIzZTQwNjYzNDQ4ZDExMDk0ZTdlMGMifQ%3D%3D; pro_ref_v2=eyJpdiI6Ik9kSUFnaGtzNTA0NzgrY2VZeElqcWc9PSIsInZhbHVlIjoidTc5OWhPTFEzUFVtQXJ1cTVmeHN0a1pXajZ3L1krenhuY1J4b2dpeW9wWEpJcmZsOGxtdEIzWUl5N2J0VnVpYSIsIm1hYyI6IjE0OTRlZWQxMmMxODZmYjIzY2JkMGNiMTY5NTU4MTkzMzNjYjYzOWU1Zjg3ZmMyZGFiOWFkYzgzNGIzYjAwNDEifQ%3D%3D; _hjSession_2058627=eyJpZCI6Ijk0NjQ2NWEyLTNmZTktNGFmOC04NDExLTMxZjk0YzEzZTY2OCIsImMiOjE3MTIzMzU0MjkwNjAsInMiOjAsInIiOjAsInNiIjowLCJzciI6MCwic2UiOjAsImZzIjowLCJzcCI6MH0=; _ga_267511960=GS1.1.1712335428.53.1.1712335432.0.0.0; sc_is_visitor_unique=rx12923067.1712335432.9327AC08AFA94F360B785E0ADF3E47E7.54.38.28.23.16.11.4.2.2; _ga=GA1.1.142919118.1711243835; _ga_5EQ309XQDG=GS1.1.1712335428.53.1.1712335432.56.0.0; cebsp_=17; XSRF-TOKEN=eyJpdiI6ImFHa2RkOEtTazQ4TmNQMUQwcks3c3c9PSIsInZhbHVlIjoiQTVoRVZHUVBORGxvaUxlbWZvWW15byttNDVva0s2THN1ZjF1cFZJMG5SakR1UUw5TlFaMENOL2dCRzBNMmg0SEczWDJFV1JJdXlEOThpd3V0dGV1NnY3UUx3cmhEZFpqTFpUTXB2V0h6b01kS0QvOUNmY2tnSk8wQndEUjYzaWkiLCJtYWMiOiIzNzNlMzk0OGE2M2I2NDU3ZDBkY2ExMGYwMmRiZGJiNGVhYjI1NjE0ODVkM2ZhMmZkZTRkZGIwNzUyZDMzMGJiIn0%3D; laravel_session=eyJpdiI6IjVNRkZsWGlkVTN3MUwrd2I1NC8xN1E9PSIsInZhbHVlIjoiMjIxdEdESUh6VnNrUU1Jc0pocXhDOTF1RXprRzNlNFRobDVIdUh0RWJScVlxcXc1N1I1WC9oeVBnUGtVOXlLQVByOURLQmFBWERtMFpPSVJhY3MzNXczL3cxMGFmbFhpSjBDT04wL3RzTVpkbVVIRjZaNG9wK0VJME1MbHlSUGgiLCJtYWMiOiJmNzhhMWZlODE4ZTUyYjQxNjJkYjU1ZTIwMGVhOTlmYmUwOTk1YmM0ZDUxY2I2ZDk1Njg3ODg2OGU2MGRhMjA0In0%3D; _ce.s=v~c0ca04eafbf1847c30a89d9d400e0c5448d7713c~lcw~1712335757672~lva~1712305600864~vpv~0~v11.fhb~1712305601185~v11.lhb~1712335754297~gtrk.la~lumwhxs4~v11.cs~442075~v11.s~ad698cd0-f36b-11ee-8459-47712d1bcdbb~v11.sla~1712335757848~v11.send~1712335548838~lcw~1712335757848");
                    var result = client.Send(message);
                    result.EnsureSuccessStatusCode();
                    var jsonResponse = result.Content.ReadAsStringAsync();
                    resumoDTO.Fii = JsonConvert.DeserializeObject<FundoImobiliarioDTO>(jsonResponse.Result);
                }

                using (var handler = new HttpClientHandler { UseCookies = false })
                using (var client = new HttpClient(handler) { BaseAddress = baseAddress })
                {
                    var message = new HttpRequestMessage(HttpMethod.Get, "/api/carteiras/proventos/" + _idCarteira + "/all/null/null/all?draw=1&columns%5B0%5D%5Bdata%5D=category&columns%5B0%5D%5Bname%5D=category&columns%5B0%5D%5Bsearchable%5D=true&columns%5B0%5D%5Borderable%5D=false&columns%5B0%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B0%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B1%5D%5Bdata%5D=ticker&columns%5B1%5D%5Bname%5D=ticker&columns%5B1%5D%5Bsearchable%5D=true&columns%5B1%5D%5Borderable%5D=false&columns%5B1%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B1%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B2%5D%5Bdata%5D=qty&columns%5B2%5D%5Bname%5D=qty&columns%5B2%5D%5Bsearchable%5D=true&columns%5B2%5D%5Borderable%5D=false&columns%5B2%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B2%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B3%5D%5Bdata%5D=type&columns%5B3%5D%5Bname%5D=type&columns%5B3%5D%5Bsearchable%5D=true&columns%5B3%5D%5Borderable%5D=false&columns%5B3%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B3%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B4%5D%5Bdata%5D=date_with&columns%5B4%5D%5Bname%5D=date_with&columns%5B4%5D%5Bsearchable%5D=true&columns%5B4%5D%5Borderable%5D=false&columns%5B4%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B4%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B5%5D%5Bdata%5D=date_payment&columns%5B5%5D%5Bname%5D=date_payment&columns%5B5%5D%5Bsearchable%5D=true&columns%5B5%5D%5Borderable%5D=false&columns%5B5%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B5%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B6%5D%5Bdata%5D=value&columns%5B6%5D%5Bname%5D=value&columns%5B6%5D%5Bsearchable%5D=true&columns%5B6%5D%5Borderable%5D=false&columns%5B6%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B6%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B7%5D%5Bdata%5D=total&columns%5B7%5D%5Bname%5D=total&columns%5B7%5D%5Bsearchable%5D=true&columns%5B7%5D%5Borderable%5D=false&columns%5B7%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B7%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B8%5D%5Bdata%5D=net_total&columns%5B8%5D%5Bname%5D=net_total&columns%5B8%5D%5Bsearchable%5D=true&columns%5B8%5D%5Borderable%5D=false&columns%5B8%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B8%5D%5Bsearch%5D%5Bregex%5D=false&start=0&length=30&search%5Bvalue%5D=&search%5Bregex%5D=false&_=1712589650156");
                    message.Headers.Add("Referer", "https://investidor10.com.br/carteiras/resumo/" + _idCarteira + "/");
                    message.Headers.Add("Sec-Ch-Ua", "\"Not A(Brand\";v=\"99\", \"Opera GX\";v=\"107\", \"Chromium\";v=\"121\"");
                    message.Headers.Add("Sec-Ch-Ua-Mobile", "?0");
                    message.Headers.Add("Sec-Ch-Ua-Platform", "\"Windows\"");
                    message.Headers.Add("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 OPR/107.0.0.0");
                    message.Headers.Add("X-Csrf-Token", "s4D8X0AYgOi7N6W3PzO2QExfC5KhLye3rokmHkwy");
                    message.Headers.Add("Cookie", "ads_popup=eyJpdiI6IktXWWpuYmpHbXFxQWhlNlovbVlvVHc9PSIsInZhbHVlIjoid1NEV0ZrOER5a1BTMU9VSnZYSmlhbHZxVlZBNFUwVzluTzlLR1dCRWZsYm5nU0l3SDBwcTltSS81QitBZTMwWklTRytMVEN1a2REU2ljcEs5U3BQS0luRmloeXd1Tlgva2NZZm1YbVVqV1k9IiwibWFjIjoiNWM5N2U0NWMzZDcxMzRhY2JjNTJhOTU4MDM4YTg0NTFlODAwNGM0N2QxZmExOTM2MDRhYmMzZWNjMTFmZTllNyJ9; sib_cuid=2eb71b24-0d30-478e-9f7f-14845f1a2ff7; SLG_G_WPT_TO=pt; _fbp=fb.2.1711243835452.776130160; SLG_GWPT_Show_Hide_tmp=1; SLG_wptGlobTipTmp=1; g_state={\"i_l\":0}; _gcl_au=1.1.181278894.1711243843; remember_web_59ba36addc2b2f9401580f014c7f58ea4e30989d=eyJpdiI6IjZUNmY5Wlgwd2JQNUxsQzEraklaT1E9PSIsInZhbHVlIjoiYVZJZFhoazhUZ3kxMnBmajh4TmFDZWtybUp6N3ZreFl5QlYzbkVuRGhpSmxCN3kwTjlaTEpsQjBZejhBSXBVcTNPaWE3S1FxLzFEbHEwT05jUEJCMnU2b3dvYTJXaElxS2JkSlBsVUNoSEFOby84dU1uUlY1ZDZZdWpzWXBIaTQ5TzRVMFNQbUF5VnNGaWQ5aHdYM3JnPT0iLCJtYWMiOiI0NDM1MDI2YjMwYWRmOTk4ZmY5YmYzOTkzZDRjMmY5Zjc4ODk1M2M0YmViMTA5NmExMzk2NTk3MDlmN2UyZTUwIn0%3D; _hjSessionUser_2058627=eyJpZCI6IjRhNGU2MmQ5LTUyZDMtNTJlMC04ZTdlLWU4MmZlOGFiZmM5NyIsImNyZWF0ZWQiOjE3MTEyNDQxODUyMzgsImV4aXN0aW5nIjp0cnVlfQ==; counter_pro=1711450640185; buy_and_hold=5; _uetvid=3a091730eb5811eea408db95503cba0d; blueID=b70e7765-08b3-4576-9eb7-69e818325628; _ga_3TXVTJSHD7=GS1.1.1711447465.1.0.1711447467.58.0.0; _ga_5EQ309XQDG=deleted; _gid=GA1.3.1279291321.1712131702; _ga_267511960=deleted; zabUserId=1712255828296zabu0.9642663688227961; zps-tgr-dts=sc%3D1-expAppOnNewSession%3D%5B%5D-pc%3D1-sesst%3D1712255828526; zpsfa_CrrM31V=1712255828708psf0.30054752858981804; cookie_contador_whole-site=eyJpdiI6Inowd05KdElOckpiSmt1L3F0N0gxUHc9PSIsInZhbHVlIjoiajFZWlNHOEZna2hUMlRRSVdSZDVtMmFxZGVYQlFCTmNNekt1VUhSYURTeXBCeUJnbEdER1NGdmhaOGZEbXhaN0ZCaTR0UHd1a1I2RDlYZ2RKbyt5ZUE9PSIsIm1hYyI6ImNhZTNjYWFlYjIyYzU5NzFmNTliNmYxYzU2MTEwNDIwOTg0ZmVhODA2ZDhiMTNjMDZhYjZjZTcwZmQ0MTg5YTAifQ%3D%3D; cookie_contador_carteira=eyJpdiI6IkdMbXJUaDFuZzVHbCtxb1FrRnFVNHc9PSIsInZhbHVlIjoidU9abzJwalJWandVd1pLTkZvOXAxaW5HdHg3ckFxcUtRWkpYeGlqaHlRR1ozRkJDa1NCd2dUeU8ySE5Jd3V6UWQycFBDK1hTaFU5N1pqcm5vNUtaYVE9PSIsIm1hYyI6ImUwNGYwOWE1ZjRhN2Q4NmZmN2Q5MDNmOTM0ZWRkNWVhOWRlNDcyZGQyZjRlN2I4ZTEwZGY4Zjc0MmY5MmE2YTIifQ%3D%3D; _ce.irv=new; cebs=1; _ce.clock_event=1; _ce.clock_data=629%2C109.51.218.16%2C1%2C36489d387fc8bef5e6ceaf2293b7a987; _CEFT=Q%3D%3D%3D; ads_popup=1; __eoi=ID=edbd65bc1056994b:T=1712331952:RT=1712331952:S=AA-AfjZM1ZzESX4WLZK6Y-JX1Tsn; click_id_197=eyJpdiI6ImlnN0hncVREQ3NXNi9zTHhpMVNwaEE9PSIsInZhbHVlIjoiVFFPc1dyOGZGVjdKTU8wUEZXTFhYZXBmaWhyejB4ODRHU2dicGlFOE5WQktCMlJQdmEvejRqUkEwN3NMbVA3ViIsIm1hYyI6IjNjOTgzYWEyZDA3MmVjOTMyYzBkMDQ4M2ZiZjkyNmJiNmZiNzE1M2UxZWIzZTQwNjYzNDQ4ZDExMDk0ZTdlMGMifQ%3D%3D; pro_ref_v2=eyJpdiI6Ik9kSUFnaGtzNTA0NzgrY2VZeElqcWc9PSIsInZhbHVlIjoidTc5OWhPTFEzUFVtQXJ1cTVmeHN0a1pXajZ3L1krenhuY1J4b2dpeW9wWEpJcmZsOGxtdEIzWUl5N2J0VnVpYSIsIm1hYyI6IjE0OTRlZWQxMmMxODZmYjIzY2JkMGNiMTY5NTU4MTkzMzNjYjYzOWU1Zjg3ZmMyZGFiOWFkYzgzNGIzYjAwNDEifQ%3D%3D; _hjSession_2058627=eyJpZCI6Ijk0NjQ2NWEyLTNmZTktNGFmOC04NDExLTMxZjk0YzEzZTY2OCIsImMiOjE3MTIzMzU0MjkwNjAsInMiOjAsInIiOjAsInNiIjowLCJzciI6MCwic2UiOjAsImZzIjowLCJzcCI6MH0=; _ga_267511960=GS1.1.1712335428.53.1.1712335432.0.0.0; sc_is_visitor_unique=rx12923067.1712335432.9327AC08AFA94F360B785E0ADF3E47E7.54.38.28.23.16.11.4.2.2; _ga=GA1.1.142919118.1711243835; _ga_5EQ309XQDG=GS1.1.1712335428.53.1.1712335432.56.0.0; cebsp_=17; XSRF-TOKEN=eyJpdiI6ImFHa2RkOEtTazQ4TmNQMUQwcks3c3c9PSIsInZhbHVlIjoiQTVoRVZHUVBORGxvaUxlbWZvWW15byttNDVva0s2THN1ZjF1cFZJMG5SakR1UUw5TlFaMENOL2dCRzBNMmg0SEczWDJFV1JJdXlEOThpd3V0dGV1NnY3UUx3cmhEZFpqTFpUTXB2V0h6b01kS0QvOUNmY2tnSk8wQndEUjYzaWkiLCJtYWMiOiIzNzNlMzk0OGE2M2I2NDU3ZDBkY2ExMGYwMmRiZGJiNGVhYjI1NjE0ODVkM2ZhMmZkZTRkZGIwNzUyZDMzMGJiIn0%3D; laravel_session=eyJpdiI6IjVNRkZsWGlkVTN3MUwrd2I1NC8xN1E9PSIsInZhbHVlIjoiMjIxdEdESUh6VnNrUU1Jc0pocXhDOTF1RXprRzNlNFRobDVIdUh0RWJScVlxcXc1N1I1WC9oeVBnUGtVOXlLQVByOURLQmFBWERtMFpPSVJhY3MzNXczL3cxMGFmbFhpSjBDT04wL3RzTVpkbVVIRjZaNG9wK0VJME1MbHlSUGgiLCJtYWMiOiJmNzhhMWZlODE4ZTUyYjQxNjJkYjU1ZTIwMGVhOTlmYmUwOTk1YmM0ZDUxY2I2ZDk1Njg3ODg2OGU2MGRhMjA0In0%3D; _ce.s=v~c0ca04eafbf1847c30a89d9d400e0c5448d7713c~lcw~1712335757672~lva~1712305600864~vpv~0~v11.fhb~1712305601185~v11.lhb~1712335754297~gtrk.la~lumwhxs4~v11.cs~442075~v11.s~ad698cd0-f36b-11ee-8459-47712d1bcdbb~v11.sla~1712335757848~v11.send~1712335548838~lcw~1712335757848");
                    var result = client.Send(message);
                    result.EnsureSuccessStatusCode();
                    var jsonResponse = result.Content.ReadAsStringAsync();
                    resumoDTO.Proventos = JsonConvert.DeserializeObject<ProventosDTO>(jsonResponse.Result);
                }

                using (var handler = new HttpClientHandler { UseCookies = false })
                using (var client = new HttpClient(handler) { BaseAddress = baseAddress })
                {
                    var message = new HttpRequestMessage(HttpMethod.Get, "\r\n/api/carteiras/proventos/" + _idCarteira + "/month/null/null/all");
                    message.Headers.Add("Referer", "https://investidor10.com.br/carteiras/resumo/" + _idCarteira + "/");
                    message.Headers.Add("Sec-Ch-Ua", "\"Not A(Brand\";v=\"99\", \"Opera GX\";v=\"107\", \"Chromium\";v=\"121\"");
                    message.Headers.Add("Sec-Ch-Ua-Mobile", "?0");
                    message.Headers.Add("Sec-Ch-Ua-Platform", "\"Windows\"");
                    message.Headers.Add("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 OPR/107.0.0.0");
                    message.Headers.Add("X-Csrf-Token", "s4D8X0AYgOi7N6W3PzO2QExfC5KhLye3rokmHkwy");
                    message.Headers.Add("Cookie", "ads_popup=eyJpdiI6IktXWWpuYmpHbXFxQWhlNlovbVlvVHc9PSIsInZhbHVlIjoid1NEV0ZrOER5a1BTMU9VSnZYSmlhbHZxVlZBNFUwVzluTzlLR1dCRWZsYm5nU0l3SDBwcTltSS81QitBZTMwWklTRytMVEN1a2REU2ljcEs5U3BQS0luRmloeXd1Tlgva2NZZm1YbVVqV1k9IiwibWFjIjoiNWM5N2U0NWMzZDcxMzRhY2JjNTJhOTU4MDM4YTg0NTFlODAwNGM0N2QxZmExOTM2MDRhYmMzZWNjMTFmZTllNyJ9; sib_cuid=2eb71b24-0d30-478e-9f7f-14845f1a2ff7; SLG_G_WPT_TO=pt; _fbp=fb.2.1711243835452.776130160; SLG_GWPT_Show_Hide_tmp=1; SLG_wptGlobTipTmp=1; g_state={\"i_l\":0}; _gcl_au=1.1.181278894.1711243843; remember_web_59ba36addc2b2f9401580f014c7f58ea4e30989d=eyJpdiI6IjZUNmY5Wlgwd2JQNUxsQzEraklaT1E9PSIsInZhbHVlIjoiYVZJZFhoazhUZ3kxMnBmajh4TmFDZWtybUp6N3ZreFl5QlYzbkVuRGhpSmxCN3kwTjlaTEpsQjBZejhBSXBVcTNPaWE3S1FxLzFEbHEwT05jUEJCMnU2b3dvYTJXaElxS2JkSlBsVUNoSEFOby84dU1uUlY1ZDZZdWpzWXBIaTQ5TzRVMFNQbUF5VnNGaWQ5aHdYM3JnPT0iLCJtYWMiOiI0NDM1MDI2YjMwYWRmOTk4ZmY5YmYzOTkzZDRjMmY5Zjc4ODk1M2M0YmViMTA5NmExMzk2NTk3MDlmN2UyZTUwIn0%3D; _hjSessionUser_2058627=eyJpZCI6IjRhNGU2MmQ5LTUyZDMtNTJlMC04ZTdlLWU4MmZlOGFiZmM5NyIsImNyZWF0ZWQiOjE3MTEyNDQxODUyMzgsImV4aXN0aW5nIjp0cnVlfQ==; counter_pro=1711450640185; buy_and_hold=5; _uetvid=3a091730eb5811eea408db95503cba0d; blueID=b70e7765-08b3-4576-9eb7-69e818325628; _ga_3TXVTJSHD7=GS1.1.1711447465.1.0.1711447467.58.0.0; _ga_5EQ309XQDG=deleted; _gid=GA1.3.1279291321.1712131702; _ga_267511960=deleted; zabUserId=1712255828296zabu0.9642663688227961; zps-tgr-dts=sc%3D1-expAppOnNewSession%3D%5B%5D-pc%3D1-sesst%3D1712255828526; zpsfa_CrrM31V=1712255828708psf0.30054752858981804; cookie_contador_whole-site=eyJpdiI6Inowd05KdElOckpiSmt1L3F0N0gxUHc9PSIsInZhbHVlIjoiajFZWlNHOEZna2hUMlRRSVdSZDVtMmFxZGVYQlFCTmNNekt1VUhSYURTeXBCeUJnbEdER1NGdmhaOGZEbXhaN0ZCaTR0UHd1a1I2RDlYZ2RKbyt5ZUE9PSIsIm1hYyI6ImNhZTNjYWFlYjIyYzU5NzFmNTliNmYxYzU2MTEwNDIwOTg0ZmVhODA2ZDhiMTNjMDZhYjZjZTcwZmQ0MTg5YTAifQ%3D%3D; cookie_contador_carteira=eyJpdiI6IkdMbXJUaDFuZzVHbCtxb1FrRnFVNHc9PSIsInZhbHVlIjoidU9abzJwalJWandVd1pLTkZvOXAxaW5HdHg3ckFxcUtRWkpYeGlqaHlRR1ozRkJDa1NCd2dUeU8ySE5Jd3V6UWQycFBDK1hTaFU5N1pqcm5vNUtaYVE9PSIsIm1hYyI6ImUwNGYwOWE1ZjRhN2Q4NmZmN2Q5MDNmOTM0ZWRkNWVhOWRlNDcyZGQyZjRlN2I4ZTEwZGY4Zjc0MmY5MmE2YTIifQ%3D%3D; _ce.irv=new; cebs=1; _ce.clock_event=1; _ce.clock_data=629%2C109.51.218.16%2C1%2C36489d387fc8bef5e6ceaf2293b7a987; _CEFT=Q%3D%3D%3D; ads_popup=1; __eoi=ID=edbd65bc1056994b:T=1712331952:RT=1712331952:S=AA-AfjZM1ZzESX4WLZK6Y-JX1Tsn; click_id_197=eyJpdiI6ImlnN0hncVREQ3NXNi9zTHhpMVNwaEE9PSIsInZhbHVlIjoiVFFPc1dyOGZGVjdKTU8wUEZXTFhYZXBmaWhyejB4ODRHU2dicGlFOE5WQktCMlJQdmEvejRqUkEwN3NMbVA3ViIsIm1hYyI6IjNjOTgzYWEyZDA3MmVjOTMyYzBkMDQ4M2ZiZjkyNmJiNmZiNzE1M2UxZWIzZTQwNjYzNDQ4ZDExMDk0ZTdlMGMifQ%3D%3D; pro_ref_v2=eyJpdiI6Ik9kSUFnaGtzNTA0NzgrY2VZeElqcWc9PSIsInZhbHVlIjoidTc5OWhPTFEzUFVtQXJ1cTVmeHN0a1pXajZ3L1krenhuY1J4b2dpeW9wWEpJcmZsOGxtdEIzWUl5N2J0VnVpYSIsIm1hYyI6IjE0OTRlZWQxMmMxODZmYjIzY2JkMGNiMTY5NTU4MTkzMzNjYjYzOWU1Zjg3ZmMyZGFiOWFkYzgzNGIzYjAwNDEifQ%3D%3D; _hjSession_2058627=eyJpZCI6Ijk0NjQ2NWEyLTNmZTktNGFmOC04NDExLTMxZjk0YzEzZTY2OCIsImMiOjE3MTIzMzU0MjkwNjAsInMiOjAsInIiOjAsInNiIjowLCJzciI6MCwic2UiOjAsImZzIjowLCJzcCI6MH0=; _ga_267511960=GS1.1.1712335428.53.1.1712335432.0.0.0; sc_is_visitor_unique=rx12923067.1712335432.9327AC08AFA94F360B785E0ADF3E47E7.54.38.28.23.16.11.4.2.2; _ga=GA1.1.142919118.1711243835; _ga_5EQ309XQDG=GS1.1.1712335428.53.1.1712335432.56.0.0; cebsp_=17; XSRF-TOKEN=eyJpdiI6ImFHa2RkOEtTazQ4TmNQMUQwcks3c3c9PSIsInZhbHVlIjoiQTVoRVZHUVBORGxvaUxlbWZvWW15byttNDVva0s2THN1ZjF1cFZJMG5SakR1UUw5TlFaMENOL2dCRzBNMmg0SEczWDJFV1JJdXlEOThpd3V0dGV1NnY3UUx3cmhEZFpqTFpUTXB2V0h6b01kS0QvOUNmY2tnSk8wQndEUjYzaWkiLCJtYWMiOiIzNzNlMzk0OGE2M2I2NDU3ZDBkY2ExMGYwMmRiZGJiNGVhYjI1NjE0ODVkM2ZhMmZkZTRkZGIwNzUyZDMzMGJiIn0%3D; laravel_session=eyJpdiI6IjVNRkZsWGlkVTN3MUwrd2I1NC8xN1E9PSIsInZhbHVlIjoiMjIxdEdESUh6VnNrUU1Jc0pocXhDOTF1RXprRzNlNFRobDVIdUh0RWJScVlxcXc1N1I1WC9oeVBnUGtVOXlLQVByOURLQmFBWERtMFpPSVJhY3MzNXczL3cxMGFmbFhpSjBDT04wL3RzTVpkbVVIRjZaNG9wK0VJME1MbHlSUGgiLCJtYWMiOiJmNzhhMWZlODE4ZTUyYjQxNjJkYjU1ZTIwMGVhOTlmYmUwOTk1YmM0ZDUxY2I2ZDk1Njg3ODg2OGU2MGRhMjA0In0%3D; _ce.s=v~c0ca04eafbf1847c30a89d9d400e0c5448d7713c~lcw~1712335757672~lva~1712305600864~vpv~0~v11.fhb~1712305601185~v11.lhb~1712335754297~gtrk.la~lumwhxs4~v11.cs~442075~v11.s~ad698cd0-f36b-11ee-8459-47712d1bcdbb~v11.sla~1712335757848~v11.send~1712335548838~lcw~1712335757848");
                    var result = client.Send(message);
                    result.EnsureSuccessStatusCode();
                    var jsonResponse = result.Content.ReadAsStringAsync();
                    resumoDTO.Resumo = jsonResponse.Result;
                }

                using (var handler = new HttpClientHandler { UseCookies = false })
                using (var client = new HttpClient(handler) { BaseAddress = baseAddress })
                {
                    var message = new HttpRequestMessage(HttpMethod.Get, "/api/carteiras/charts/diversificacao/" + _idCarteira + "/all");
                    message.Headers.Add("Referer", "https://investidor10.com.br/carteiras/resumo/" + _idCarteira + "/");
                    message.Headers.Add("Sec-Ch-Ua", "\"Not A(Brand\";v=\"99\", \"Opera GX\";v=\"107\", \"Chromium\";v=\"121\"");
                    message.Headers.Add("Sec-Ch-Ua-Mobile", "?0");
                    message.Headers.Add("Sec-Ch-Ua-Platform", "\"Windows\"");
                    message.Headers.Add("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 OPR/107.0.0.0");
                    message.Headers.Add("X-Csrf-Token", "s4D8X0AYgOi7N6W3PzO2QExfC5KhLye3rokmHkwy");
                    message.Headers.Add("Cookie", "ads_popup=eyJpdiI6IktXWWpuYmpHbXFxQWhlNlovbVlvVHc9PSIsInZhbHVlIjoid1NEV0ZrOER5a1BTMU9VSnZYSmlhbHZxVlZBNFUwVzluTzlLR1dCRWZsYm5nU0l3SDBwcTltSS81QitBZTMwWklTRytMVEN1a2REU2ljcEs5U3BQS0luRmloeXd1Tlgva2NZZm1YbVVqV1k9IiwibWFjIjoiNWM5N2U0NWMzZDcxMzRhY2JjNTJhOTU4MDM4YTg0NTFlODAwNGM0N2QxZmExOTM2MDRhYmMzZWNjMTFmZTllNyJ9; sib_cuid=2eb71b24-0d30-478e-9f7f-14845f1a2ff7; SLG_G_WPT_TO=pt; _fbp=fb.2.1711243835452.776130160; SLG_GWPT_Show_Hide_tmp=1; SLG_wptGlobTipTmp=1; g_state={\"i_l\":0}; _gcl_au=1.1.181278894.1711243843; remember_web_59ba36addc2b2f9401580f014c7f58ea4e30989d=eyJpdiI6IjZUNmY5Wlgwd2JQNUxsQzEraklaT1E9PSIsInZhbHVlIjoiYVZJZFhoazhUZ3kxMnBmajh4TmFDZWtybUp6N3ZreFl5QlYzbkVuRGhpSmxCN3kwTjlaTEpsQjBZejhBSXBVcTNPaWE3S1FxLzFEbHEwT05jUEJCMnU2b3dvYTJXaElxS2JkSlBsVUNoSEFOby84dU1uUlY1ZDZZdWpzWXBIaTQ5TzRVMFNQbUF5VnNGaWQ5aHdYM3JnPT0iLCJtYWMiOiI0NDM1MDI2YjMwYWRmOTk4ZmY5YmYzOTkzZDRjMmY5Zjc4ODk1M2M0YmViMTA5NmExMzk2NTk3MDlmN2UyZTUwIn0%3D; _hjSessionUser_2058627=eyJpZCI6IjRhNGU2MmQ5LTUyZDMtNTJlMC04ZTdlLWU4MmZlOGFiZmM5NyIsImNyZWF0ZWQiOjE3MTEyNDQxODUyMzgsImV4aXN0aW5nIjp0cnVlfQ==; counter_pro=1711450640185; buy_and_hold=5; _uetvid=3a091730eb5811eea408db95503cba0d; blueID=b70e7765-08b3-4576-9eb7-69e818325628; _ga_3TXVTJSHD7=GS1.1.1711447465.1.0.1711447467.58.0.0; _ga_5EQ309XQDG=deleted; _gid=GA1.3.1279291321.1712131702; _ga_267511960=deleted; zabUserId=1712255828296zabu0.9642663688227961; zps-tgr-dts=sc%3D1-expAppOnNewSession%3D%5B%5D-pc%3D1-sesst%3D1712255828526; zpsfa_CrrM31V=1712255828708psf0.30054752858981804; cookie_contador_whole-site=eyJpdiI6Inowd05KdElOckpiSmt1L3F0N0gxUHc9PSIsInZhbHVlIjoiajFZWlNHOEZna2hUMlRRSVdSZDVtMmFxZGVYQlFCTmNNekt1VUhSYURTeXBCeUJnbEdER1NGdmhaOGZEbXhaN0ZCaTR0UHd1a1I2RDlYZ2RKbyt5ZUE9PSIsIm1hYyI6ImNhZTNjYWFlYjIyYzU5NzFmNTliNmYxYzU2MTEwNDIwOTg0ZmVhODA2ZDhiMTNjMDZhYjZjZTcwZmQ0MTg5YTAifQ%3D%3D; cookie_contador_carteira=eyJpdiI6IkdMbXJUaDFuZzVHbCtxb1FrRnFVNHc9PSIsInZhbHVlIjoidU9abzJwalJWandVd1pLTkZvOXAxaW5HdHg3ckFxcUtRWkpYeGlqaHlRR1ozRkJDa1NCd2dUeU8ySE5Jd3V6UWQycFBDK1hTaFU5N1pqcm5vNUtaYVE9PSIsIm1hYyI6ImUwNGYwOWE1ZjRhN2Q4NmZmN2Q5MDNmOTM0ZWRkNWVhOWRlNDcyZGQyZjRlN2I4ZTEwZGY4Zjc0MmY5MmE2YTIifQ%3D%3D; _ce.irv=new; cebs=1; _ce.clock_event=1; _ce.clock_data=629%2C109.51.218.16%2C1%2C36489d387fc8bef5e6ceaf2293b7a987; _CEFT=Q%3D%3D%3D; ads_popup=1; __eoi=ID=edbd65bc1056994b:T=1712331952:RT=1712331952:S=AA-AfjZM1ZzESX4WLZK6Y-JX1Tsn; click_id_197=eyJpdiI6ImlnN0hncVREQ3NXNi9zTHhpMVNwaEE9PSIsInZhbHVlIjoiVFFPc1dyOGZGVjdKTU8wUEZXTFhYZXBmaWhyejB4ODRHU2dicGlFOE5WQktCMlJQdmEvejRqUkEwN3NMbVA3ViIsIm1hYyI6IjNjOTgzYWEyZDA3MmVjOTMyYzBkMDQ4M2ZiZjkyNmJiNmZiNzE1M2UxZWIzZTQwNjYzNDQ4ZDExMDk0ZTdlMGMifQ%3D%3D; pro_ref_v2=eyJpdiI6Ik9kSUFnaGtzNTA0NzgrY2VZeElqcWc9PSIsInZhbHVlIjoidTc5OWhPTFEzUFVtQXJ1cTVmeHN0a1pXajZ3L1krenhuY1J4b2dpeW9wWEpJcmZsOGxtdEIzWUl5N2J0VnVpYSIsIm1hYyI6IjE0OTRlZWQxMmMxODZmYjIzY2JkMGNiMTY5NTU4MTkzMzNjYjYzOWU1Zjg3ZmMyZGFiOWFkYzgzNGIzYjAwNDEifQ%3D%3D; _hjSession_2058627=eyJpZCI6Ijk0NjQ2NWEyLTNmZTktNGFmOC04NDExLTMxZjk0YzEzZTY2OCIsImMiOjE3MTIzMzU0MjkwNjAsInMiOjAsInIiOjAsInNiIjowLCJzciI6MCwic2UiOjAsImZzIjowLCJzcCI6MH0=; _ga_267511960=GS1.1.1712335428.53.1.1712335432.0.0.0; sc_is_visitor_unique=rx12923067.1712335432.9327AC08AFA94F360B785E0ADF3E47E7.54.38.28.23.16.11.4.2.2; _ga=GA1.1.142919118.1711243835; _ga_5EQ309XQDG=GS1.1.1712335428.53.1.1712335432.56.0.0; cebsp_=17; XSRF-TOKEN=eyJpdiI6ImFHa2RkOEtTazQ4TmNQMUQwcks3c3c9PSIsInZhbHVlIjoiQTVoRVZHUVBORGxvaUxlbWZvWW15byttNDVva0s2THN1ZjF1cFZJMG5SakR1UUw5TlFaMENOL2dCRzBNMmg0SEczWDJFV1JJdXlEOThpd3V0dGV1NnY3UUx3cmhEZFpqTFpUTXB2V0h6b01kS0QvOUNmY2tnSk8wQndEUjYzaWkiLCJtYWMiOiIzNzNlMzk0OGE2M2I2NDU3ZDBkY2ExMGYwMmRiZGJiNGVhYjI1NjE0ODVkM2ZhMmZkZTRkZGIwNzUyZDMzMGJiIn0%3D; laravel_session=eyJpdiI6IjVNRkZsWGlkVTN3MUwrd2I1NC8xN1E9PSIsInZhbHVlIjoiMjIxdEdESUh6VnNrUU1Jc0pocXhDOTF1RXprRzNlNFRobDVIdUh0RWJScVlxcXc1N1I1WC9oeVBnUGtVOXlLQVByOURLQmFBWERtMFpPSVJhY3MzNXczL3cxMGFmbFhpSjBDT04wL3RzTVpkbVVIRjZaNG9wK0VJME1MbHlSUGgiLCJtYWMiOiJmNzhhMWZlODE4ZTUyYjQxNjJkYjU1ZTIwMGVhOTlmYmUwOTk1YmM0ZDUxY2I2ZDk1Njg3ODg2OGU2MGRhMjA0In0%3D; _ce.s=v~c0ca04eafbf1847c30a89d9d400e0c5448d7713c~lcw~1712335757672~lva~1712305600864~vpv~0~v11.fhb~1712305601185~v11.lhb~1712335754297~gtrk.la~lumwhxs4~v11.cs~442075~v11.s~ad698cd0-f36b-11ee-8459-47712d1bcdbb~v11.sla~1712335757848~v11.send~1712335548838~lcw~1712335757848");
                    var result = client.Send(message);
                    result.EnsureSuccessStatusCode();
                    var jsonResponse = result.Content.ReadAsStringAsync();
                    resumoDTO.Carteira = JsonConvert.DeserializeObject<List<CarteiraDTO>>(jsonResponse.Result);
                }

                using (var handler = new HttpClientHandler { UseCookies = false })
                using (var client = new HttpClient(handler) { BaseAddress = baseAddress })
                {
                    var message = new HttpRequestMessage(HttpMethod.Get, "/api/carteiras/lancamentos/" + _idCarteira + "/1?draw=1&columns%5B0%5D%5Bdata%5D=type_investment&columns%5B0%5D%5Bname%5D=type_investment&columns%5B0%5D%5Bsearchable%5D=true&columns%5B0%5D%5Borderable%5D=false&columns%5B0%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B0%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B1%5D%5Bdata%5D=ticker&columns%5B1%5D%5Bname%5D=ticker&columns%5B1%5D%5Bsearchable%5D=true&columns%5B1%5D%5Borderable%5D=false&columns%5B1%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B1%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B2%5D%5Bdata%5D=type&columns%5B2%5D%5Bname%5D=type&columns%5B2%5D%5Bsearchable%5D=true&columns%5B2%5D%5Borderable%5D=false&columns%5B2%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B2%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B3%5D%5Bdata%5D=date&columns%5B3%5D%5Bname%5D=date&columns%5B3%5D%5Bsearchable%5D=true&columns%5B3%5D%5Borderable%5D=false&columns%5B3%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B3%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B4%5D%5Bdata%5D=qty&columns%5B4%5D%5Bname%5D=qty&columns%5B4%5D%5Bsearchable%5D=true&columns%5B4%5D%5Borderable%5D=false&columns%5B4%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B4%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B5%5D%5Bdata%5D=price&columns%5B5%5D%5Bname%5D=price&columns%5B5%5D%5Bsearchable%5D=true&columns%5B5%5D%5Borderable%5D=false&columns%5B5%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B5%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B6%5D%5Bdata%5D=total&columns%5B6%5D%5Bname%5D=total&columns%5B6%5D%5Bsearchable%5D=true&columns%5B6%5D%5Borderable%5D=false&columns%5B6%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B6%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B7%5D%5Bdata%5D=source&columns%5B7%5D%5Bname%5D=source&columns%5B7%5D%5Bsearchable%5D=true&columns%5B7%5D%5Borderable%5D=false&columns%5B7%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B7%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B8%5D%5Bdata%5D=edit&columns%5B8%5D%5Bname%5D=&columns%5B8%5D%5Bsearchable%5D=true&columns%5B8%5D%5Borderable%5D=false&columns%5B8%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B8%5D%5Bsearch%5D%5Bregex%5D=false&start=0&length=10&search%5Bvalue%5D=&search%5Bregex%5D=false&_=1712619638884");
                    message.Headers.Add("Referer", "https://investidor10.com.br/carteiras/resumo/" + _idCarteira + "/");
                    message.Headers.Add("Sec-Ch-Ua", "\"Not A(Brand\";v=\"99\", \"Opera GX\";v=\"107\", \"Chromium\";v=\"121\"");
                    message.Headers.Add("Sec-Ch-Ua-Mobile", "?0");
                    message.Headers.Add("Sec-Ch-Ua-Platform", "\"Windows\"");
                    message.Headers.Add("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 OPR/107.0.0.0");
                    message.Headers.Add("X-Csrf-Token", "s4D8X0AYgOi7N6W3PzO2QExfC5KhLye3rokmHkwy");
                    message.Headers.Add("Cookie", "ads_popup=eyJpdiI6IktXWWpuYmpHbXFxQWhlNlovbVlvVHc9PSIsInZhbHVlIjoid1NEV0ZrOER5a1BTMU9VSnZYSmlhbHZxVlZBNFUwVzluTzlLR1dCRWZsYm5nU0l3SDBwcTltSS81QitBZTMwWklTRytMVEN1a2REU2ljcEs5U3BQS0luRmloeXd1Tlgva2NZZm1YbVVqV1k9IiwibWFjIjoiNWM5N2U0NWMzZDcxMzRhY2JjNTJhOTU4MDM4YTg0NTFlODAwNGM0N2QxZmExOTM2MDRhYmMzZWNjMTFmZTllNyJ9; sib_cuid=2eb71b24-0d30-478e-9f7f-14845f1a2ff7; SLG_G_WPT_TO=pt; _fbp=fb.2.1711243835452.776130160; SLG_GWPT_Show_Hide_tmp=1; SLG_wptGlobTipTmp=1; g_state={\"i_l\":0}; _gcl_au=1.1.181278894.1711243843; remember_web_59ba36addc2b2f9401580f014c7f58ea4e30989d=eyJpdiI6IjZUNmY5Wlgwd2JQNUxsQzEraklaT1E9PSIsInZhbHVlIjoiYVZJZFhoazhUZ3kxMnBmajh4TmFDZWtybUp6N3ZreFl5QlYzbkVuRGhpSmxCN3kwTjlaTEpsQjBZejhBSXBVcTNPaWE3S1FxLzFEbHEwT05jUEJCMnU2b3dvYTJXaElxS2JkSlBsVUNoSEFOby84dU1uUlY1ZDZZdWpzWXBIaTQ5TzRVMFNQbUF5VnNGaWQ5aHdYM3JnPT0iLCJtYWMiOiI0NDM1MDI2YjMwYWRmOTk4ZmY5YmYzOTkzZDRjMmY5Zjc4ODk1M2M0YmViMTA5NmExMzk2NTk3MDlmN2UyZTUwIn0%3D; _hjSessionUser_2058627=eyJpZCI6IjRhNGU2MmQ5LTUyZDMtNTJlMC04ZTdlLWU4MmZlOGFiZmM5NyIsImNyZWF0ZWQiOjE3MTEyNDQxODUyMzgsImV4aXN0aW5nIjp0cnVlfQ==; counter_pro=1711450640185; buy_and_hold=5; _uetvid=3a091730eb5811eea408db95503cba0d; blueID=b70e7765-08b3-4576-9eb7-69e818325628; _ga_3TXVTJSHD7=GS1.1.1711447465.1.0.1711447467.58.0.0; _ga_5EQ309XQDG=deleted; _gid=GA1.3.1279291321.1712131702; _ga_267511960=deleted; zabUserId=1712255828296zabu0.9642663688227961; zps-tgr-dts=sc%3D1-expAppOnNewSession%3D%5B%5D-pc%3D1-sesst%3D1712255828526; zpsfa_CrrM31V=1712255828708psf0.30054752858981804; cookie_contador_whole-site=eyJpdiI6Inowd05KdElOckpiSmt1L3F0N0gxUHc9PSIsInZhbHVlIjoiajFZWlNHOEZna2hUMlRRSVdSZDVtMmFxZGVYQlFCTmNNekt1VUhSYURTeXBCeUJnbEdER1NGdmhaOGZEbXhaN0ZCaTR0UHd1a1I2RDlYZ2RKbyt5ZUE9PSIsIm1hYyI6ImNhZTNjYWFlYjIyYzU5NzFmNTliNmYxYzU2MTEwNDIwOTg0ZmVhODA2ZDhiMTNjMDZhYjZjZTcwZmQ0MTg5YTAifQ%3D%3D; cookie_contador_carteira=eyJpdiI6IkdMbXJUaDFuZzVHbCtxb1FrRnFVNHc9PSIsInZhbHVlIjoidU9abzJwalJWandVd1pLTkZvOXAxaW5HdHg3ckFxcUtRWkpYeGlqaHlRR1ozRkJDa1NCd2dUeU8ySE5Jd3V6UWQycFBDK1hTaFU5N1pqcm5vNUtaYVE9PSIsIm1hYyI6ImUwNGYwOWE1ZjRhN2Q4NmZmN2Q5MDNmOTM0ZWRkNWVhOWRlNDcyZGQyZjRlN2I4ZTEwZGY4Zjc0MmY5MmE2YTIifQ%3D%3D; _ce.irv=new; cebs=1; _ce.clock_event=1; _ce.clock_data=629%2C109.51.218.16%2C1%2C36489d387fc8bef5e6ceaf2293b7a987; _CEFT=Q%3D%3D%3D; ads_popup=1; __eoi=ID=edbd65bc1056994b:T=1712331952:RT=1712331952:S=AA-AfjZM1ZzESX4WLZK6Y-JX1Tsn; click_id_197=eyJpdiI6ImlnN0hncVREQ3NXNi9zTHhpMVNwaEE9PSIsInZhbHVlIjoiVFFPc1dyOGZGVjdKTU8wUEZXTFhYZXBmaWhyejB4ODRHU2dicGlFOE5WQktCMlJQdmEvejRqUkEwN3NMbVA3ViIsIm1hYyI6IjNjOTgzYWEyZDA3MmVjOTMyYzBkMDQ4M2ZiZjkyNmJiNmZiNzE1M2UxZWIzZTQwNjYzNDQ4ZDExMDk0ZTdlMGMifQ%3D%3D; pro_ref_v2=eyJpdiI6Ik9kSUFnaGtzNTA0NzgrY2VZeElqcWc9PSIsInZhbHVlIjoidTc5OWhPTFEzUFVtQXJ1cTVmeHN0a1pXajZ3L1krenhuY1J4b2dpeW9wWEpJcmZsOGxtdEIzWUl5N2J0VnVpYSIsIm1hYyI6IjE0OTRlZWQxMmMxODZmYjIzY2JkMGNiMTY5NTU4MTkzMzNjYjYzOWU1Zjg3ZmMyZGFiOWFkYzgzNGIzYjAwNDEifQ%3D%3D; _hjSession_2058627=eyJpZCI6Ijk0NjQ2NWEyLTNmZTktNGFmOC04NDExLTMxZjk0YzEzZTY2OCIsImMiOjE3MTIzMzU0MjkwNjAsInMiOjAsInIiOjAsInNiIjowLCJzciI6MCwic2UiOjAsImZzIjowLCJzcCI6MH0=; _ga_267511960=GS1.1.1712335428.53.1.1712335432.0.0.0; sc_is_visitor_unique=rx12923067.1712335432.9327AC08AFA94F360B785E0ADF3E47E7.54.38.28.23.16.11.4.2.2; _ga=GA1.1.142919118.1711243835; _ga_5EQ309XQDG=GS1.1.1712335428.53.1.1712335432.56.0.0; cebsp_=17; XSRF-TOKEN=eyJpdiI6ImFHa2RkOEtTazQ4TmNQMUQwcks3c3c9PSIsInZhbHVlIjoiQTVoRVZHUVBORGxvaUxlbWZvWW15byttNDVva0s2THN1ZjF1cFZJMG5SakR1UUw5TlFaMENOL2dCRzBNMmg0SEczWDJFV1JJdXlEOThpd3V0dGV1NnY3UUx3cmhEZFpqTFpUTXB2V0h6b01kS0QvOUNmY2tnSk8wQndEUjYzaWkiLCJtYWMiOiIzNzNlMzk0OGE2M2I2NDU3ZDBkY2ExMGYwMmRiZGJiNGVhYjI1NjE0ODVkM2ZhMmZkZTRkZGIwNzUyZDMzMGJiIn0%3D; laravel_session=eyJpdiI6IjVNRkZsWGlkVTN3MUwrd2I1NC8xN1E9PSIsInZhbHVlIjoiMjIxdEdESUh6VnNrUU1Jc0pocXhDOTF1RXprRzNlNFRobDVIdUh0RWJScVlxcXc1N1I1WC9oeVBnUGtVOXlLQVByOURLQmFBWERtMFpPSVJhY3MzNXczL3cxMGFmbFhpSjBDT04wL3RzTVpkbVVIRjZaNG9wK0VJME1MbHlSUGgiLCJtYWMiOiJmNzhhMWZlODE4ZTUyYjQxNjJkYjU1ZTIwMGVhOTlmYmUwOTk1YmM0ZDUxY2I2ZDk1Njg3ODg2OGU2MGRhMjA0In0%3D; _ce.s=v~c0ca04eafbf1847c30a89d9d400e0c5448d7713c~lcw~1712335757672~lva~1712305600864~vpv~0~v11.fhb~1712305601185~v11.lhb~1712335754297~gtrk.la~lumwhxs4~v11.cs~442075~v11.s~ad698cd0-f36b-11ee-8459-47712d1bcdbb~v11.sla~1712335757848~v11.send~1712335548838~lcw~1712335757848");
                    var result = client.Send(message);
                    result.EnsureSuccessStatusCode();
                    var jsonResponse = result.Content.ReadAsStringAsync();
                    resumoDTO.Lancamentos = JsonConvert.DeserializeObject<LancamentosDTO>(jsonResponse.Result);
                }

                using (var handler = new HttpClientHandler { UseCookies = false })
                using (var client = new HttpClient(handler) { BaseAddress = baseAddress })
                {
                    var message = new HttpRequestMessage(HttpMethod.Get, "/api/carteiras/proventos/" + _idCarteira + "/all/null/null/all?draw=1&columns%5B0%5D%5Bdata%5D=category&columns%5B0%5D%5Bname%5D=category&columns%5B0%5D%5Bsearchable%5D=true&columns%5B0%5D%5Borderable%5D=false&columns%5B0%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B0%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B1%5D%5Bdata%5D=ticker&columns%5B1%5D%5Bname%5D=ticker&columns%5B1%5D%5Bsearchable%5D=true&columns%5B1%5D%5Borderable%5D=false&columns%5B1%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B1%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B2%5D%5Bdata%5D=qty&columns%5B2%5D%5Bname%5D=qty&columns%5B2%5D%5Bsearchable%5D=true&columns%5B2%5D%5Borderable%5D=false&columns%5B2%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B2%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B3%5D%5Bdata%5D=type&columns%5B3%5D%5Bname%5D=type&columns%5B3%5D%5Bsearchable%5D=true&columns%5B3%5D%5Borderable%5D=false&columns%5B3%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B3%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B4%5D%5Bdata%5D=date_with&columns%5B4%5D%5Bname%5D=date_with&columns%5B4%5D%5Bsearchable%5D=true&columns%5B4%5D%5Borderable%5D=false&columns%5B4%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B4%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B5%5D%5Bdata%5D=date_payment&columns%5B5%5D%5Bname%5D=date_payment&columns%5B5%5D%5Bsearchable%5D=true&columns%5B5%5D%5Borderable%5D=false&columns%5B5%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B5%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B6%5D%5Bdata%5D=value&columns%5B6%5D%5Bname%5D=value&columns%5B6%5D%5Bsearchable%5D=true&columns%5B6%5D%5Borderable%5D=false&columns%5B6%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B6%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B7%5D%5Bdata%5D=total&columns%5B7%5D%5Bname%5D=total&columns%5B7%5D%5Bsearchable%5D=true&columns%5B7%5D%5Borderable%5D=false&columns%5B7%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B7%5D%5Bsearch%5D%5Bregex%5D=false&columns%5B8%5D%5Bdata%5D=net_total&columns%5B8%5D%5Bname%5D=net_total&columns%5B8%5D%5Bsearchable%5D=true&columns%5B8%5D%5Borderable%5D=false&columns%5B8%5D%5Bsearch%5D%5Bvalue%5D=&columns%5B8%5D%5Bsearch%5D%5Bregex%5D=false&start=0&length=30&search%5Bvalue%5D=&search%5Bregex%5D=false&_=1712695888321");
                    message.Headers.Add("Referer", "https://investidor10.com.br/carteiras/resumo/" + _idCarteira + "/");
                    message.Headers.Add("Sec-Ch-Ua", "\"Not A(Brand\";v=\"99\", \"Opera GX\";v=\"107\", \"Chromium\";v=\"121\"");
                    message.Headers.Add("Sec-Ch-Ua-Mobile", "?0");
                    message.Headers.Add("Sec-Ch-Ua-Platform", "\"Windows\"");
                    message.Headers.Add("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 OPR/107.0.0.0");
                    message.Headers.Add("X-Csrf-Token", "s4D8X0AYgOi7N6W3PzO2QExfC5KhLye3rokmHkwy");
                    message.Headers.Add("Cookie", "ads_popup=eyJpdiI6IktXWWpuYmpHbXFxQWhlNlovbVlvVHc9PSIsInZhbHVlIjoid1NEV0ZrOER5a1BTMU9VSnZYSmlhbHZxVlZBNFUwVzluTzlLR1dCRWZsYm5nU0l3SDBwcTltSS81QitBZTMwWklTRytMVEN1a2REU2ljcEs5U3BQS0luRmloeXd1Tlgva2NZZm1YbVVqV1k9IiwibWFjIjoiNWM5N2U0NWMzZDcxMzRhY2JjNTJhOTU4MDM4YTg0NTFlODAwNGM0N2QxZmExOTM2MDRhYmMzZWNjMTFmZTllNyJ9; sib_cuid=2eb71b24-0d30-478e-9f7f-14845f1a2ff7; SLG_G_WPT_TO=pt; _fbp=fb.2.1711243835452.776130160; SLG_GWPT_Show_Hide_tmp=1; SLG_wptGlobTipTmp=1; g_state={\"i_l\":0}; _gcl_au=1.1.181278894.1711243843; remember_web_59ba36addc2b2f9401580f014c7f58ea4e30989d=eyJpdiI6IjZUNmY5Wlgwd2JQNUxsQzEraklaT1E9PSIsInZhbHVlIjoiYVZJZFhoazhUZ3kxMnBmajh4TmFDZWtybUp6N3ZreFl5QlYzbkVuRGhpSmxCN3kwTjlaTEpsQjBZejhBSXBVcTNPaWE3S1FxLzFEbHEwT05jUEJCMnU2b3dvYTJXaElxS2JkSlBsVUNoSEFOby84dU1uUlY1ZDZZdWpzWXBIaTQ5TzRVMFNQbUF5VnNGaWQ5aHdYM3JnPT0iLCJtYWMiOiI0NDM1MDI2YjMwYWRmOTk4ZmY5YmYzOTkzZDRjMmY5Zjc4ODk1M2M0YmViMTA5NmExMzk2NTk3MDlmN2UyZTUwIn0%3D; _hjSessionUser_2058627=eyJpZCI6IjRhNGU2MmQ5LTUyZDMtNTJlMC04ZTdlLWU4MmZlOGFiZmM5NyIsImNyZWF0ZWQiOjE3MTEyNDQxODUyMzgsImV4aXN0aW5nIjp0cnVlfQ==; counter_pro=1711450640185; buy_and_hold=5; _uetvid=3a091730eb5811eea408db95503cba0d; blueID=b70e7765-08b3-4576-9eb7-69e818325628; _ga_3TXVTJSHD7=GS1.1.1711447465.1.0.1711447467.58.0.0; _ga_5EQ309XQDG=deleted; _gid=GA1.3.1279291321.1712131702; _ga_267511960=deleted; zabUserId=1712255828296zabu0.9642663688227961; zps-tgr-dts=sc%3D1-expAppOnNewSession%3D%5B%5D-pc%3D1-sesst%3D1712255828526; zpsfa_CrrM31V=1712255828708psf0.30054752858981804; cookie_contador_whole-site=eyJpdiI6Inowd05KdElOckpiSmt1L3F0N0gxUHc9PSIsInZhbHVlIjoiajFZWlNHOEZna2hUMlRRSVdSZDVtMmFxZGVYQlFCTmNNekt1VUhSYURTeXBCeUJnbEdER1NGdmhaOGZEbXhaN0ZCaTR0UHd1a1I2RDlYZ2RKbyt5ZUE9PSIsIm1hYyI6ImNhZTNjYWFlYjIyYzU5NzFmNTliNmYxYzU2MTEwNDIwOTg0ZmVhODA2ZDhiMTNjMDZhYjZjZTcwZmQ0MTg5YTAifQ%3D%3D; cookie_contador_carteira=eyJpdiI6IkdMbXJUaDFuZzVHbCtxb1FrRnFVNHc9PSIsInZhbHVlIjoidU9abzJwalJWandVd1pLTkZvOXAxaW5HdHg3ckFxcUtRWkpYeGlqaHlRR1ozRkJDa1NCd2dUeU8ySE5Jd3V6UWQycFBDK1hTaFU5N1pqcm5vNUtaYVE9PSIsIm1hYyI6ImUwNGYwOWE1ZjRhN2Q4NmZmN2Q5MDNmOTM0ZWRkNWVhOWRlNDcyZGQyZjRlN2I4ZTEwZGY4Zjc0MmY5MmE2YTIifQ%3D%3D; _ce.irv=new; cebs=1; _ce.clock_event=1; _ce.clock_data=629%2C109.51.218.16%2C1%2C36489d387fc8bef5e6ceaf2293b7a987; _CEFT=Q%3D%3D%3D; ads_popup=1; __eoi=ID=edbd65bc1056994b:T=1712331952:RT=1712331952:S=AA-AfjZM1ZzESX4WLZK6Y-JX1Tsn; click_id_197=eyJpdiI6ImlnN0hncVREQ3NXNi9zTHhpMVNwaEE9PSIsInZhbHVlIjoiVFFPc1dyOGZGVjdKTU8wUEZXTFhYZXBmaWhyejB4ODRHU2dicGlFOE5WQktCMlJQdmEvejRqUkEwN3NMbVA3ViIsIm1hYyI6IjNjOTgzYWEyZDA3MmVjOTMyYzBkMDQ4M2ZiZjkyNmJiNmZiNzE1M2UxZWIzZTQwNjYzNDQ4ZDExMDk0ZTdlMGMifQ%3D%3D; pro_ref_v2=eyJpdiI6Ik9kSUFnaGtzNTA0NzgrY2VZeElqcWc9PSIsInZhbHVlIjoidTc5OWhPTFEzUFVtQXJ1cTVmeHN0a1pXajZ3L1krenhuY1J4b2dpeW9wWEpJcmZsOGxtdEIzWUl5N2J0VnVpYSIsIm1hYyI6IjE0OTRlZWQxMmMxODZmYjIzY2JkMGNiMTY5NTU4MTkzMzNjYjYzOWU1Zjg3ZmMyZGFiOWFkYzgzNGIzYjAwNDEifQ%3D%3D; _hjSession_2058627=eyJpZCI6Ijk0NjQ2NWEyLTNmZTktNGFmOC04NDExLTMxZjk0YzEzZTY2OCIsImMiOjE3MTIzMzU0MjkwNjAsInMiOjAsInIiOjAsInNiIjowLCJzciI6MCwic2UiOjAsImZzIjowLCJzcCI6MH0=; _ga_267511960=GS1.1.1712335428.53.1.1712335432.0.0.0; sc_is_visitor_unique=rx12923067.1712335432.9327AC08AFA94F360B785E0ADF3E47E7.54.38.28.23.16.11.4.2.2; _ga=GA1.1.142919118.1711243835; _ga_5EQ309XQDG=GS1.1.1712335428.53.1.1712335432.56.0.0; cebsp_=17; XSRF-TOKEN=eyJpdiI6ImFHa2RkOEtTazQ4TmNQMUQwcks3c3c9PSIsInZhbHVlIjoiQTVoRVZHUVBORGxvaUxlbWZvWW15byttNDVva0s2THN1ZjF1cFZJMG5SakR1UUw5TlFaMENOL2dCRzBNMmg0SEczWDJFV1JJdXlEOThpd3V0dGV1NnY3UUx3cmhEZFpqTFpUTXB2V0h6b01kS0QvOUNmY2tnSk8wQndEUjYzaWkiLCJtYWMiOiIzNzNlMzk0OGE2M2I2NDU3ZDBkY2ExMGYwMmRiZGJiNGVhYjI1NjE0ODVkM2ZhMmZkZTRkZGIwNzUyZDMzMGJiIn0%3D; laravel_session=eyJpdiI6IjVNRkZsWGlkVTN3MUwrd2I1NC8xN1E9PSIsInZhbHVlIjoiMjIxdEdESUh6VnNrUU1Jc0pocXhDOTF1RXprRzNlNFRobDVIdUh0RWJScVlxcXc1N1I1WC9oeVBnUGtVOXlLQVByOURLQmFBWERtMFpPSVJhY3MzNXczL3cxMGFmbFhpSjBDT04wL3RzTVpkbVVIRjZaNG9wK0VJME1MbHlSUGgiLCJtYWMiOiJmNzhhMWZlODE4ZTUyYjQxNjJkYjU1ZTIwMGVhOTlmYmUwOTk1YmM0ZDUxY2I2ZDk1Njg3ODg2OGU2MGRhMjA0In0%3D; _ce.s=v~c0ca04eafbf1847c30a89d9d400e0c5448d7713c~lcw~1712335757672~lva~1712305600864~vpv~0~v11.fhb~1712305601185~v11.lhb~1712335754297~gtrk.la~lumwhxs4~v11.cs~442075~v11.s~ad698cd0-f36b-11ee-8459-47712d1bcdbb~v11.sla~1712335757848~v11.send~1712335548838~lcw~1712335757848");
                    var result = client.Send(message);
                    result.EnsureSuccessStatusCode();
                    var jsonResponse = result.Content.ReadAsStringAsync();
                    resumoDTO.ProventosInfo = JsonConvert.DeserializeObject<ProventosDTO>(jsonResponse.Result);
                }

                resumoDTO.DataAtualizado = DateTime.Now;
                resumoDTO.Iniciado = true;

                HttpContext.Session.SetString(SessionIdCarteira, _idCarteira);
                HttpContext.Session.SetString(SessionCarteira, JsonConvert.SerializeObject(resumoDTO));
            }

            return Ok(resumoDTO);
        }

        public IActionResult Resumo(string ativo, string categoria)
        {
            switch (categoria)
            {
                case "acao":
                    carregaAcao(ativo);
                    break;

                case "fii":
                    carregaFii(ativo);
                    break;

                default:
                    break;
            }

            return View(resumoDTO);
        }

        private void carregaAcao(string ativo)
        {
            using (var handler = new HttpClientHandler { UseCookies = false })
            using (var client = new HttpClient(handler) { BaseAddress = baseAddress })
            {
                var message = new HttpRequestMessage(HttpMethod.Get, "/acoes/" + ativo + "/");
                message.Headers.Add("Referer", "https://investidor10.com.br/carteiras/resumo/779708/");
                message.Headers.Add("Sec-Ch-Ua", "\"Not A(Brand\";v=\"99\", \"Opera GX\";v=\"107\", \"Chromium\";v=\"121\"");
                message.Headers.Add("Sec-Ch-Ua-Mobile", "?0");
                message.Headers.Add("Sec-Ch-Ua-Platform", "\"Windows\"");
                message.Headers.Add("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 OPR/107.0.0.0");
                message.Headers.Add("X-Csrf-Token", "s4D8X0AYgOi7N6W3PzO2QExfC5KhLye3rokmHkwy");
                var result = client.Send(message);
                result.EnsureSuccessStatusCode();
                var jsonResponse = result.Content.ReadAsStringAsync();
                resumoDTO.Resumo = jsonResponse.Result;
            }
        }

        private void carregaFii(string ativo)
        {
            using (var handler = new HttpClientHandler { UseCookies = false })
            using (var client = new HttpClient(handler) { BaseAddress = baseAddress })
            {
                var message = new HttpRequestMessage(HttpMethod.Get, "/fiis/" + ativo + "/");
                message.Headers.Add("Referer", "https://investidor10.com.br/carteiras/resumo/779708/");
                message.Headers.Add("Sec-Ch-Ua", "\"Not A(Brand\";v=\"99\", \"Opera GX\";v=\"107\", \"Chromium\";v=\"121\"");
                message.Headers.Add("Sec-Ch-Ua-Mobile", "?0");
                message.Headers.Add("Sec-Ch-Ua-Platform", "\"Windows\"");
                message.Headers.Add("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 OPR/107.0.0.0");
                message.Headers.Add("X-Csrf-Token", "s4D8X0AYgOi7N6W3PzO2QExfC5KhLye3rokmHkwy");
                var result = client.Send(message);
                result.EnsureSuccessStatusCode();
                var jsonResponse = result.Content.ReadAsStringAsync();
                resumoDTO.Resumo = jsonResponse.Result;
            }
        }
    }
}